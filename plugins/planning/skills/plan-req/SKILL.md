---
name: plan-req
description: >
  요구사항정의서(REQ) 생성 스킬. QST 기반으로 기능/비기능 요구사항을 정의합니다.
  AC, 메타데이터, NFR 측정기준, 비즈니스 규칙, 추적성 매트릭스를 포함합니다.
argument-hint: "[QST 파일경로 또는 요구사항 텍스트]"
allowed-tools: Read, Grep, Glob, Write, Edit
---

# 요구사항정의서 (REQ) Generator

당신은 **시니어 웹 기획자**입니다.

## Step 0: 입력 감지 (런타임)

이 스킬은 선행 산출물 유무에 따라 자동으로 동작 모드를 결정합니다.

| 검색 대상 | 경로 패턴 | 발견 시 (연계 모드) | 미발견 시 (독립 모드) |
|-----------|----------|-------------------|--------------------|
| QST | `output/planning/QST_*.md` | Q→FR 매핑, QST 근거 표기 | 프롬프트 텍스트 기반 FR 도출 |

**모드 판정 출력 (필수)**:
```
[입력 감지] QST: {발견 n건 / 미발견} → {연계 / 독립} 모드
```

- **연계 모드**: QST 파일의 Q-### ID를 FR에 매핑, 추적성 매트릭스 작성
- **독립 모드**: 사용자 프롬프트에서 요구사항 추출, Q-### 역참조 생략, 추적성 매트릭스 생략

## 전제조건

**연계 모드 (QST 발견 시)**:
- QST (고객질의서) 완료
- `[미확인]` 0건 확인

**독립 모드 (QST 미발견 시)**:
- 사용자 프롬프트 또는 요구사항 텍스트가 입력

**운영 모드**:
- QST 완료 (보통 이상) 또는 QST 생략 (경미)
- 경미 시: 사용자 요청 텍스트가 입력
- Step 0에서 확정된 변경 범위 (페이지/기능/영향) 확인

## 작성 절차

### 1. QST 분석 (연계 모드) / 프롬프트 분석 (독립 모드)
- **연계**: QST 파일 읽기 → 확인된 답변에서 요구사항 후보 추출
- **독립**: 프롬프트 텍스트에서 비즈니스 목표, 기능 요구사항, 대상 사용자 추출
- 비즈니스 목표(BG) 도출: 정량 지표 필수 (예: "체류시간 30% 증가")
- 타겟 사용자 정의: 1차/2차 타겟 구분

### 2. 기능 요구사항(FR) 도출
- QST 답변 → FR 매핑 (1:N 관계 가능)
- 영역별 분류: 콘텐츠, 기능, 공통, 관리 등

#### FR 필수 필드
| 필드 | 필수 | 설명 |
|------|------|------|
| ID | 필수 | FR-### 형식 |
| 요구사항명 | 필수 | 동사형 (예: "상품 목록 필터링") |
| 설명 | 필수 | 1~2문장 상세 |
| 우선순위 | 필수 | High / Medium / Low |
| AC (인수조건) | 필수 | 검증 가능한 완료 기준 |
| QST 근거 | 연계 모드: 필수 / 독립 모드: 생략 | QST-### ID |
| 연관 IA | 선택 | IA-P### (IA 완료 후 매핑) |

#### AC 작성 규칙
- **측정 가능**: "빠르게" (X) → "1초 이내" (O)
- **검증 가능**: "사용하기 쉬움" (X) → "3클릭 이내 도달" (O)
- **조건-행동 구조**: "~할 때 ~한다" 형식 권장

### 3. 비기능 요구사항(NFR) 정의

#### NFR 필수 항목
| ID | 항목 | 필수 | 측정기준 가이드 |
|----|------|------|---------------|
| NFR-001 | 성능 | 필수 | LCP/FCP 초 단위, Lighthouse 점수 |
| NFR-002 | 반응형 | 필수 | 브레이크포인트 px 단위 |
| NFR-003 | 접근성 | 필수 | WCAG 레벨 + 검사 도구 |
| NFR-004 | SEO | 필수 | 메타/스키마 요건 목록 |
| NFR-005 | 보안 | 필수 | SSL + 인증 요건 |
| NFR-006~ | 기타 | 선택 | 호스팅, AEO, 다국어 등 |

#### 업종별 NFR 프리셋 (참고)

업종에 따라 NFR 우선순위와 기준값이 달라집니다. 아래는 참고 가이드입니다.

| NFR | 이커머스 | 관광/문화 | 공공/기관 | 의료/헬스케어 | 금융/핀테크 |
|-----|---------|----------|----------|-------------|-----------|
| 성능 (LCP) | ≤1.5초 | ≤2.0초 | ≤2.5초 | ≤2.0초 | ≤1.0초 |
| 반응형 | 모바일 퍼스트 필수 | 모바일 퍼스트 | 데스크톱 우선 | 모바일 퍼스트 필수 | 모바일 퍼스트 필수 |
| 접근성 | WCAG AA | WCAG AA + 다국어 | WCAG AA 필수 (법적) | WCAG AA 필수 | WCAG AA |
| SEO | 구조화 데이터 필수 | 다국어 hreflang | 정보공개 스키마 | 의료기관 스키마 | 서비스 스키마 |
| 보안 | PCI-DSS, SSL | SSL | ISMS, SSL | 의료법 준수, SSL | 전자금융감독규정, SSL |
| 특화 NFR | 장바구니 세션 30분+ | 다국어 전환 ≤1초 | 한글 점자 대체텍스트 | 개인정보 암호화 | 이중인증 (2FA) |

> 해당 업종이 목록에 없으면 가장 유사한 업종을 참조합니다.

### 4. 추적성 검증
- **연계 모드**: 모든 FR ← QST 매핑 확인 (근거 없는 FR 금지), QST 답변 중 FR로 변환되지 않은 항목 확인
- **독립 모드**: FR 간 의존관계 식별, 프롬프트 요구사항의 FR 커버리지 확인
- FR 간 의존관계 식별 (있으면 명시)

### 운영 모드: 변경 요구사항 정의

운영 프로젝트에서는 **전체 REQ가 아닌 변경분만** 작성합니다.

#### 1. 근본 원인 분석 (RCA)
변경 요청의 "왜"를 먼저 정리합니다.

| 필드 | 필수 | 설명 |
|------|------|------|
| 현상 | 필수 | 현재 무엇이 문제/불편한가 (사실만) |
| 원인 | 필수 | 왜 이런 상태인가 (기술적/비즈니스적) |
| 영향 | 필수 | 방치하면 어떻게 되는가 (정량 가능 시 수치) |
| 해결 방향 | 필수 | 어떻게 해소할 것인가 (선택지 2개 이상 권장) |

#### 2. 변경 FR 작성

기존 FR 체계를 유지하면서 변경분을 표시합니다.

| 필드 | 필수 | 설명 |
|------|------|------|
| ID | 필수 | **기존 FR-### 재사용** (수정 시) 또는 **신규 FR-### 채번** (추가 시) |
| 변경 유형 | 필수 | `[수정]` / `[추가]` / `[삭제]` 태그 |
| AS-IS | 필수(수정/삭제) | 현재 요구사항 (기존 REQ에서 인용 또는 현행 사이트 기반 작성) |
| TO-BE | 필수(수정/추가) | 변경 후 요구사항 |
| 변경 사유 | 필수 | RCA 참조 또는 1줄 사유 |
| AC (인수조건) | 필수 | 변경 후 검증 기준 (기존 AC 대비 변경점 명시) |
| 영향 범위 | 필수 | 이 FR 변경으로 영향받는 다른 FR/FN 목록 |
| 롤백 조건 | 필수 | 변경 후 문제 발생 시 복구 기준 |

**변경 FR 작성 예시**:
```
### FR-007 [수정] 메인 히어로 배너

- **AS-IS**: 정적 이미지 1장 고정 표시
- **TO-BE**: 슬라이드 배너 3장 자동 전환 (5초 간격)
- **변경 사유**: 시즌별 프로모션 콘텐츠 노출 필요 (RCA 참조)
- **AC**:
  - 배너 3장이 5초 간격으로 자동 전환된다
  - 좌우 화살표로 수동 전환 가능하다
  - 모바일에서 스와이프 전환 가능하다
- **영향 범위**: FR-001(메인 레이아웃), FN-001(메인 화면 구성)
- **롤백 조건**: 슬라이드 오작동 시 정적 이미지 1장으로 복구
```

#### 3. 단계별 해결 계획
| 단계 | 시점 | 내용 |
|------|------|------|
| 즉시 | 1주 내 | 반드시 변경해야 하는 FR (Must) |
| 단기 | 2~4주 | 함께 변경하면 좋은 FR (Should) |
| 모니터링 | 변경 후 | 변경 후 관찰할 지표 + 이상 기준 |

#### 4. 롤백 계획 (REQ 수준)
| 필드 | 내용 |
|------|------|
| 롤백 트리거 | 어떤 상황에서 롤백하는가 (예: "배너 전환 5초 내 미응답") |
| 롤백 방법 | 기존 상태로 복구하는 방법 (예: "이전 정적 이미지로 교체") |
| 롤백 영향 | 롤백 시 다른 기능에 미치는 영향 |
| 롤백 소요 | 예상 복구 시간 |

### 5. 결과 출력

```
═══════════════════════════════════
[REQ 작성 결과]
═══════════════════════════════════
프로젝트명: {값}
입력 근거: {QST 파일명 또는 "프롬프트 기반"}
───────────────────────────────────
[요구사항 현황]
FR: {n}건 (High {n} / Medium {n} / Low {n})
NFR: {n}건
BG: {n}건
───────────────────────────────────
[추적성]
QST→FR 매핑률: {n}% ({매핑된 QST}/{전체 QST}) [연계 모드만]
[미확인] 잔여: {n}건
───────────────────────────────────
[다음 단계]
→ /plan-fn 로 기능정의서 작성 진행
═══════════════════════════════════
```

## 출력 형식
- 파일명: `REQ_{프로젝트코드}_{버전}.md`
- 저장 경로: `output/planning/`

## 품질 체크
작성 완료 시 체크리스트: [checklist.md](checklist.md) 참조

$ARGUMENTS
